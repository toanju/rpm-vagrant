From a6760dd8e7743e048cb2f38c474e05889356e8ac Mon Sep 17 00:00:00 2001
From: hendrenj <jay.hendren@Colorado.EDU>
Date: Tue, 19 Jul 2016 11:22:35 -0600
Subject: [PATCH] fixes #7610

---
 plugins/guests/linux/cap/public_key.rb | 1 +
 1 file changed, 1 insertion(+)

diff --git a/plugins/guests/linux/cap/public_key.rb b/plugins/guests/linux/cap/public_key.rb
index 92a7182..3d57f55 100644
--- a/plugins/guests/linux/cap/public_key.rb
+++ b/plugins/guests/linux/cap/public_key.rb
@@ -54,6 +54,7 @@ def self.remove_public_key(machine, contents)
             if test -f ~/.ssh/authorized_keys; then
               grep -v -x -f '#{remote_path}' ~/.ssh/authorized_keys > ~/.ssh/authorized_keys.tmp
               mv ~/.ssh/authorized_keys.tmp ~/.ssh/authorized_keys
+              chmod 0600 ~/.ssh/authorized_keys
             fi
 
             rm -f '#{remote_path}'
